{% extends 'layout.html' %}

{% block page_title %}Buscar - Almac√©n de fotos{% endblock %}

{% block sidebar %}
{% include 'photostore/_sidebar.html' %}

{% if por_keywords: %}
<ul class="collection with-header">
    <li class="collection-header"><h5>Palabras claves</h5></li>
    {% for k in por_keywords: %}
    <li class="collection-item"><span class="badge new" data-badge-caption="">{{ por_keywords[k]|length }}</span>{{ k }}</li>
    {% endfor %}
</ul>
{% endif %}

{{ super() }}
{% endblock %}


{% block content %}

<div class="row">
    <form action="{{ url_for('.buscar_indice') }}" method="POST" class="col s12 px-5">
        {{ form.csrf_token }}
        <div class="col s11 input-field">
            <i class="material-icons prefix">search</i>
            <input id="userq_field" type="search" class="validate" name="userquery" value="{{ form.userquery.data or '' }}" required>
            <label class="active" for="userq_field">Buscar</label>
        </div>
        <div class="col s1 input-field">
            <button class="btn waves-effect waves-light" type="submit" name="action">
                <i class="material-icons">search</i>
            </button>
        </div>
    </form>
</div>

<div class="row px-5">
    {% if fotos %}
    <div class="col s12">
        <div class="photos-search-results">
            {% for foto in fotos %}
                <div class="card photo-search-results-item">
                    <div class="card-image">
                        <a href="#!"><img src="{{ url_for('.photo_thumbnail', id=foto.md5) }}"></a>
                        <a class="btn-floating halfway-fab waves-effect waves-light grey activator"><i class="material-icons">more_vert</i></a>
                    </div>
                    <div class="card-action">
                        <a class="waves-effect waves-light btn"><i class="material-icons">content_copy</i></a>
                    </div>
                    <div class="card-reveal">
                        <span class="card-title grey-text text-darken-4">{{ foto.headline }}<i class="material-icons right">close</i></span>
                        <p>{{ render_excerpt(foto.excerpt)|safe }}</p>
                        <i class="material-icons left">label</i> 
                        {% for k in foto.keywords %}
                        <div class="chip">{{ k }}</div>
                        {% endfor %}

                        <p><i class="material-icons left">person</i> {{ foto.taken_by }}</p>
                        <p><i class="material-icons left">file_upload</i> {{foto.uploader.name}}</p>
                        <p><i class="material-icons left">event</i> {{foto.taken_on}}</p>
                        <!-- opcionales -->
                        {% if foto.camera %}<p><i class="material-icons left">camera_alt</i> {{foto.camera}}</p>{% endif %}
                        {% if foto.fnumber %}<p><i class="material-icons left">camera</i> f/{{foto.fnumber}}</p>{% endif %}
                        {% if foto.exposuretime %}<p><i class="material-icons left">av_timer</i> {{foto.exposuretime}}s</p>{% endif %}
                        {% if foto.focal %}<p><i class="material-icons left">lens</i> {{foto.focal}}mm</p>{% endif %}
                        {% if foto.isovalue %}<p><i class="material-icons left">iso</i> {{foto.isovalue}}</p>{% endif %}
                        {% if foto.software %}<p><i class="material-icons left">brush</i> {{foto.software}}</p>{% endif %}
                        <!-- en opcionales -->
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <!--
    {% for foto in fotos %}
    <div class="col s4">
        <div class="card">
            <div class="card-image">
                <img src="{{ url_for('.photo_thumbnail', id=foto.md5) }}">
                <a class="btn-floating halfway-fab waves-effect waves-light grey activator"><i class="material-icons">more_vert</i></a>
            </div>
            <div class="card-action">
                <a class="waves-effect waves-light btn"><i class="material-icons">content_copy</i></a>
            </div>
            <div class="card-reveal">
                <span class="card-title grey-text text-darken-4">{{ foto.headline }}<i class="material-icons right">close</i></span>
                <p>{{ render_excerpt(foto.excerpt)|safe }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
    -->
    {% else %}
        <div class="card col s12">
            <div class="card-content">
                <span class="card-title center-align">
                {{"No se encontraron resultados" if form.userquery.data else "Escribe para buscar"}}
                </span>
            </div>
        </div>
    {% endif %}
</div>

{% endblock content%}
